<div class="submit-button">
  <button
    (click)="changeInvoice()"
    [class.selected-button]="!isPreviewSelected"
    [class.deselected-button]="isPreviewSelected"
  >
    Edit
  </button>
  <button
    (click)="submitInvoice()"
    [class.selected-button]="isPreviewSelected"
    [class.deselected-button]="!isPreviewSelected"
  >
    Preview
  </button>
</div>

<div *ngIf="editInvoice" class="container">
  <div class="a4-box">
    <div class="header">
      <div class="left business-left">TAX INVOICE</div>

      <div class="center business-title">
        <app-custom-typehead-dropdown
          [placeholder]="'Select Business'"
          [options]="businessOptions"
          (selectedOptions)="selectedBusiness($event)"
          [value]="invoiceModel.businessName"
          (clearOptions)="clearBusiness($event)"
          [required]="false"
        ></app-custom-typehead-dropdown>
      </div>
      <div class="business-right">
        <app-custom-input-box
          [placeholder]="'Mobile Number'"
          [value]="invoiceModel.mobileNumber"
          [disable]="true"
          [onlyInput]="true"
          [inputClass]="'custom-input'"
        >
        </app-custom-input-box>
        <!-- <br /> -->
        <app-custom-input-box
          [placeholder]="'Alternate Mobile Number'"
          [value]="invoiceModel.alternateMobileNumber"
          [disable]="true"
          [onlyInput]="true"
          [inputClass]="'custom-input'"
        >
        </app-custom-input-box>
      </div>
    </div>
    <div class="address">
      <div class="address-div">
        <app-custom-input-box
          [placeholder]="'Address Line 1'"
          [value]="invoiceModel.addressLine1"
          [disable]="true"
          [onlyInput]="true"
          [inputClass]="'custom-input address1'"
        ></app-custom-input-box>
      </div>
      <div class="email-input">
        <app-custom-input-box
          [placeholder]="'Email'"
          [value]="invoiceModel.businessEmail"
          [disable]="true"
          [onlyInput]="true"
          [inputClass]="'custom-input '"
        ></app-custom-input-box>
      </div>
    </div>
    <div class="details">
      <div class="billed-div">
        <div><strong>Billed To:</strong></div>
        <div>
          <app-custom-typehead-dropdown
            [placeholder]="'Select Client'"
            [options]="clientOptions"
            (selectedOptions)="selectedClient($event)"
            [value]="invoiceModel.clientName"
            (clearOptions)="clearClient($event)"
            [required]="false"
          ></app-custom-typehead-dropdown>
        </div>
        <div>
          <app-custom-input-box
            [placeholder]="'Client Address'"
            [value]="invoiceModel.clientAddress"
            [disable]="true"
            [onlyInput]="true"
            [inputClass]="'custom-input'"
          ></app-custom-input-box>
        </div>
        <div>
          <app-custom-input-box
            [placeholder]="'City State Zip'"
            [value]="invoiceModel.cityStateZip"
            [disable]="true"
            [onlyInput]="true"
            [inputClass]="'custom-input'"
          ></app-custom-input-box>
        </div>
        <div>
          <app-custom-input-box
            [placeholder]="'Mobile'"
            [value]="invoiceModel.clientMobile"
            [disable]="true"
            [onlyInput]="true"
            [inputClass]="'custom-input'"
          ></app-custom-input-box>
        </div>
        <div class="col-12">
          <div class="row">
            <div class="col-12 sub-section">
              <div style="width: 23%"><strong>Client's GSTIN:</strong></div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'GSTIN'"
                  [value]="invoiceModel.clientGst"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="invoice-div">
        <div class="col-12">
          <div class="row">
            <div class="col-12 sub-section">
              <div style="width: 50%"><strong>Invoice No:</strong></div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'Invoice No'"
                  [value]="invoiceModel.invoiceNo"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12">
          <div class="row">
            <div class="col-12 sub-section">
              <div style="width: 50%"><strong>Order No:</strong></div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'Order No'"
                  [value]="invoiceModel.orderNo"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12">
          <div class="row">
            <div class="col-12 sub-section">
              <div style="width: 50%"><strong>Date</strong></div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'Date'"
                  [value]="invoiceModel.date"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
          </div>
        </div>
        <!-- Add other invoice information here -->
      </div>
    </div>
    <div class="item-details">
      <table>
        <thead>
          <tr>
            <th class="col-no" rowspan="2">No</th>
            <th class="col-description" rowspan="2">Description</th>
            <th class="col-code" rowspan="2">Code</th>
            <th class="col-qty" rowspan="2">Qty</th>
            <th class="col-unit-price" rowspan="2">Unit Price</th>
            <th class="col-total" rowspan="2">Total</th>
            <th class="col-tax" colspan="3">Tax</th>
            <th class="col-total-amount" rowspan="2">Total Amount</th>
          </tr>
          <tr>
            <th class="col-cgst">CGST</th>
            <th class="col-igst">IGST</th>
            <th class="col-sgst">SGST</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of invoiceModel.items; let i = index">
            <td class="col-no">{{ i + 1 }}</td>
            <td class="item-td col-description">
              <app-custom-typehead-dropdown
                [required]="false"
                [placeholder]="'Item Description'"
                [options]="itemOptions"
                [value]="invoiceModel.items[i].description"
                name="itemDescription"
                (selectedOptions)="selectItem($event, i)"
                ngDefaultControl
              ></app-custom-typehead-dropdown>
            </td>
            <td class="item-td col-code">
              <app-custom-input-box
                [placeholder]="'HSN Code'"
                [value]="invoiceModel.items[i].hsnCode"
                [disable]="true"
                [onlyInput]="true"
                [inputClass]="'custom-input section-input invoice-input'"
                [inputDiv]="'hsn-input-div'"
                ngDefaultControl
              ></app-custom-input-box>
            </td>
            <td class="item-td col-qty">
              <app-custom-input-box
                [placeholder]="'Qty'"
                [(ngModel)]="invoiceModel.items[i].qty"
                [disable]="false"
                [onlyInput]="true"
                [inputClass]="'custom-input section-input qty-input'"
                (blur)="calculateTotal(i)"
                [inputDiv]="'qty-input-div'"
                ngDefaultControl
              ></app-custom-input-box>
            </td>
            <td class="item-td col-unit-price">
              <app-custom-input-box
                [placeholder]="'Unit Price'"
                [(ngModel)]="invoiceModel.items[i].unitPrice"
                [onlyInput]="true"
                [inputClass]="'custom-input section-input invoice-input'"
                (blur)="calculateTotal(i)"
                ngDefaultControl
              ></app-custom-input-box>
            </td>
            <td class="item-td col-total">
              <app-custom-input-box
                [placeholder]="'Total Before tax'"
                [value]="invoiceModel.items[i].totalAmountBT"
                [disable]="true"
                [onlyInput]="true"
                [inputClass]="'custom-input section-input total-input'"
                ngDefaultControl
              ></app-custom-input-box>
            </td>
            <td class="item-td col-cgst">
              <app-custom-input-box
                [placeholder]="'CGST'"
                [(ngModel)]="invoiceModel.items[i].cgst"
                (blur)="calculateTotal(i)"
                [onlyInput]="true"
                [inputClass]="'custom-input section-input tax-input'"
                ngDefaultControl
              ></app-custom-input-box>
            </td>
            <td class="item-td col-igst">
              <app-custom-input-box
                [placeholder]="'IGST'"
                [value]="invoiceModel.items[i].igst"
                [(ngModel)]="invoiceModel.items[i].igst"
                (blur)="calculateTotal(i)"
                [onlyInput]="true"
                [inputClass]="'custom-input section-input tax-input'"
                ngDefaultControl
              ></app-custom-input-box>
            </td>
            <td class="item-td col-sgst">
              <app-custom-input-box
                [placeholder]="'SGST'"
                [(ngModel)]="invoiceModel.items[i].sgst"
                (blur)="calculateTotal(i)"
                [onlyInput]="true"
                [inputClass]="'custom-input section-input tax-input'"
                ngDefaultControl
              ></app-custom-input-box>
            </td>
            <td class="item-td col-total-amount">
              <app-custom-input-box
                [placeholder]="'Total Amount'"
                [value]="invoiceModel.items[i].totalAmountAT"
                [disable]="true"
                [onlyInput]="true"
                [inputClass]="'custom-input section-input total-amount-input'"
                ngDefaultControl
              ></app-custom-input-box>
            </td>
          </tr>
          <tr class="subtotal-row">
            <td class="subtotal-empty-row" colspan="5">Sub Total:</td>
            <!-- colspan for columns before the "Total Amount" column -->
            <td class="subtotal-amount-row">{{ invoiceModel.subTotal }}</td>
            <!-- Subtotal -->
            <td class="subtotal-empty-row" colspan="3">Total Amount:</td>
            <!-- colspan for tax columns -->
            <td class="subtotal-amount-row">
              {{ invoiceModel.totalAmountAfterTax }}
            </td>
            <!-- Total Amount After Tax -->
          </tr>
        </tbody>
      </table>
      <button (click)="addItem()" class="add-button">Add Item</button>
    </div>

    <!-- Tax details section -->
    <div class="tax-details">
      <div class="left gst-left">
        <div class="section col-12">
          <div class="row">
            <div class="col-6 sub-section">
              <div style="width: 25%"><strong>GSTIN:</strong></div>

              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'GSTIN'"
                  [value]="invoiceModel.gstin"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
            <div class="col-6 sub-section">
              <div style="width: 26%"><strong>PAN:</strong></div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'PAN'"
                  [value]="invoiceModel.pan"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
            <div class="col-6 sub-section">
              <div style="width: 25%"><strong>State:</strong></div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'State'"
                  [value]="invoiceModel.state"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
          </div>
          <!-- <strong>GSTIN:</strong> -->
        </div>
        <!-- <div class="section"></div> -->
        <!-- <div class="section">
          <strong>State:</strong>
          <input type="text" [(ngModel)]="state" placeholder="State" />
        </div> -->
        <div class="section col-12">
          <div class="row">
            <div class="col-12 sub-section mt-2">
              <div style="width: 30%"><strong>Amount in Words:</strong></div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'Amount in Words'"
                  [value]="invoiceModel.amountInWords"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
          </div>
        </div>
        <div class="section col-12">
          <strong>Bank Details:</strong><br />
          <div class="row">
            <div class="col-12 sub-section mt-2">
              <div style="width: 25%">Bank A/C No :</div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'Bank A/C No'"
                  [value]="invoiceModel.accountNo"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
            <div class="col-12 sub-section">
              <div style="width: 25%">IFSC :</div>
              <div class="section-custom-input">
                <app-custom-input-box
                  [placeholder]="'IFSC'"
                  [value]="invoiceModel.ifsc"
                  [disable]="true"
                  [onlyInput]="true"
                  [inputClass]="'custom-input section-input'"
                ></app-custom-input-box>
              </div>
            </div>
          </div>

          <!-- <input
            type="text"
            [(ngModel)]="accountNo"
            placeholder="Account No"
          />, IFSC -
          <input type="text" [(ngModel)]="ifsc" placeholder="IFSC" /> -->
        </div>
        <div class="section">
          <strong>Terms & Conditions:</strong>
          <textarea
            [(ngModel)]="termsConditions"
            placeholder="Terms & Conditions"
          ></textarea>
        </div>
      </div>
      <div class="right gst-right">
        <div class="tax-row">
          <div class="tax-title">Taxable Amount:</div>
          <div class="tax-percentage">$18</div>
          <div class="tax-amount">$100.00</div>
        </div>
        <div class="tax-row">
          <div class="tax-title">CGST:</div>
          <div class="tax-percentage">10%</div>
          <div class="tax-amount">$5.00</div>
        </div>
        <div class="tax-row">
          <div class="tax-title">SGST:</div>
          <div class="tax-percentage">10%</div>
          <div class="tax-amount">$5.00</div>
        </div>
        <div class="tax-row">
          <div class="tax-title">IGST:</div>
          <div class="tax-percentage">20%</div>
          <div class="tax-amount">$10.00</div>
        </div>
        <div class="tax-row">
          <div class="tax-title">IGST:</div>
          <div class="tax-percentage">20%</div>
          <div class="tax-amount">$10.00</div>
        </div>
        <div class="tax-row">
          <div class="tax-title">IGST:</div>
          <div class="tax-percentage">20%</div>
          <div class="tax-amount">$10.00</div>
        </div>
        <div class="tax-row">
          <div class="tax-title">IGST:</div>
          <div class="tax-percentage">20%</div>
          <div class="tax-amount">$10.00</div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="showPreview" class="preview-container">
  <app-view-invoice [invoiceData]="submittedInvoice"></app-view-invoice>
</div>
